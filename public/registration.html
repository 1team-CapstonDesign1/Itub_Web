<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title> I-Tub </title>
    <link rel="stylesheet" href="main.css">
</head>

<body bgcolor="#000000" text="#ffffff" link="000ff" vlink="808080">
    <h1>회원가입</h1>
    <form>
        <div>
            <label id='nickname'>별명:</label>
            <input type="text" id="name" />
        </div>
        <div>
            <label for="gender">성별:</label>
            <input type="radio" id="gender" name="gender" value="남" /> <span class="up"> 남성 </span>
            <input type="radio" id="gender" name="gender" value="여" /> <span class="up"> 여성 </span>
        </div>
        <div>
            <label for="age">나이:</label>
            <input type="number" id="age" />
        </div>
        <div>
            <label for="msg">자기소개:</label> <textarea id="msg"></textarea>
        </div>
        <input type="button" value="취소" onclick='alert("구현중")' />
        <input type="button" value="등록" onclick='alert("구현중")' />

        <div>
            <label class="nickname">별명:</label>
            <input type="text" id="nick_input"/>
        </div>
        <div>
            <button class="refer">조회</button>
            <label id="find">조회테스트 : </label>
        </div>
        <div>
            <input type="button" class="del" value="삭제"/>
            <label class="dele">삭제테스트 : </label>
        </div>
    </form>

    <script>
        document.querySelector('.refer').addEventListener('click', function(){
            var inputdata = document.getElementById('nick_input');
            console.log(inputdata)
            // 배열로도 정의 가능
            sendAjax('/db/reference', inputdata.value);
        });

        document.querySelector('.del').addEventListener('click', function(){
            var inputdata = document.forms[0].elements[0].value 
            console.log(inputdata)
            // 배열로도 정의 가능
            sendAjax('/db/delete', inputdata)
        });

        function sendAjax(url, data){
            var data = {'data': data};
            data = JSON.stringify(data); // json을 문자열 형태로 만들어줌
            console.log(data)
            var xhr = new XMLHttpRequest();
            xhr.open('POST', url);
            xhr.setRequestHeader('Content-Type', "application/json"); 
            // 서버로 보낼때 json 형태의 데이터를 보내기위해 지정
            xhr.send(data); // 문자열 형태로 넣어줘야함

            xhr.addEventListener('load', function(){
                var result = JSON.parse(xhr.responseText);
                var resultDiv = document.querySelector('.find');

                console.log(result.u_name)
                if(result.result !== 'ok') resultDiv.innerHTML = "not found"
                else resultDiv.innerHTML = result.u_name;
            });
        }
    </script>
</body>

</html>